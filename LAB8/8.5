clear all; close all;



A_ = [1 0.99 0.98;
      0.99 1 0.99;
      0.98 0.99 1];


A2 = [1 1 1;
      1 1.0001 1;
      1 1 1.0002];


A3 = [4 0.5 0.2 0.1;
      0.5 3 0.3 0.2;
      0.2 0.3 2 0.4;
      0.1 0.2 0.4 1];

A4 = magic(5);


A = A_;  

% ======= Iteracyjna dekompozycja QR =======
[N, ~] = size(A);  % Rozmiar macierzy

% Inicjalizacja macierzy wynikowej
A_ = A;  % Kopia macierzy A
for i = 1:30  % 30 iteracji
    [Q, R] = qr(A_);  % Dekompzycja QR
    A_ = R * Q;  
end  

% ======= Wyniki =======
lambda = diag(A_);       % Wartości własne na przekątnej
ref = eig(A);            % Wartości własne z MATLAB-a

% ======= Wyświetlanie wyników =======
disp('Macierz analizowana:');
disp(A);

disp('Wartości własne z metody QR:');
disp(lambda);

disp('Wartości własne z funkcji eig:');
disp(ref);
